import{j as e,A as y,S as o}from"./sweetalert2.all.BzjA5z2z.js";import{r as a}from"./index.BVOCwoKb.js";import{P as M}from"./Paginacion.DN2WiRaF.js";import{m as V}from"./ManejarRespuesta.Bd8-Nm9C.js";const L=({itemsPerPage:b=10})=>{const[i,v]=a.useState([]),[r,c]=a.useState(1),[N,w]=a.useState(1),[P,d]=a.useState(!1),[x,u]=a.useState(""),[p,m]=a.useState(""),[h,g]=a.useState(""),[f,j]=a.useState(""),l=async(t=1)=>{d(!0);try{const s=await fetch(`${y}/api/postulados/lista/candidato?page=${t-1}&size=${b}&estado=${x}&fechaMinima=${p}&tituloVacante=${h}&empresa=${f}`,{credentials:"include"}),n=await V(s);v(n.postulados),w(n.totalPage)}catch(s){console.error("❌ Error al cargar postulaciones:",s)}finally{d(!1)}};a.useEffect(()=>{l(r)},[r]);const C=()=>{c(1),l(1)},E=()=>{u(""),m(""),g(""),j(""),c(1),l(1)},$=t=>{window.location.href=`/empleos/${t}`},S=async(t,s,n)=>{const{isConfirmed:F}=await o.fire({title:"Cancelar postulación",text:"¿Estás seguro de que deseas cancelar esta postulación?",icon:"question",showCancelButton:!0,confirmButtonText:"Sí, cancelar",cancelButtonText:"No",reverseButtons:!0});if(F)try{(await fetch(`${y}/api/postulados/cancelar/${t}?estado=${s}&nvacante=${n}`,{method:"PATCH",credentials:"include"})).status===204?(await o.fire({text:"Postulación cancelada exitosamente.",icon:"success"}),l(r)):await o.fire({text:"No se pudo cancelar la Postulacion",icon:"error"})}catch{await o.fire({text:"❌ Ocurrió un error al cancelar la postulación.",icon:"error"})}};return e.jsxs("div",{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Filtrar Postulaciones"}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsx("input",{type:"text",value:h,onChange:t=>g(t.target.value),placeholder:"Filtrar por Vacante",className:"px-4 py-2 border rounded-lg flex-1 min-w-[200px]"}),e.jsx("input",{type:"text",value:f,onChange:t=>j(t.target.value),placeholder:"Filtrar por Empresa",className:"px-4 py-2 border rounded-lg flex-1 min-w-[200px]"}),e.jsxs("select",{value:x,onChange:t=>u(t.target.value),className:"px-4 py-2 border rounded-lg flex-1 min-w-[200px]",children:[e.jsx("option",{value:"",children:"Filtrar por Estado"}),e.jsx("option",{value:"Espera",children:"En Espera"}),e.jsx("option",{value:"Aceptada",children:"Aceptada"}),e.jsx("option",{value:"Rechazada",children:"Rechazada"})]}),e.jsx("input",{type:"date",value:p,onChange:t=>m(t.target.value),className:"px-4 py-2 border rounded-lg flex-1 min-w-[200px]"})]}),e.jsxs("div",{className:"mt-4 flex gap-4",children:[e.jsx("button",{onClick:C,className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg transition duration-200",children:"Buscar"}),e.jsx("button",{onClick:E,className:"bg-gray-500 hover:bg-gray-600 text-white font-semibold py-2 px-4 rounded-lg transition duration-200",children:"Limpiar Filtros"})]})]}),P?e.jsx("p",{children:"Cargando postulaciones..."}):i.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center p-8 text-center text-gray-600",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-16 h-16 mb-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v1m0 14v1m8-8h-1M5 12H4m15.364-6.364l-.707.707M6.343 17.657l-.707.707m12.021 0l-.707-.707M6.343 6.343l-.707-.707M12 8a4 4 0 100 8 4 4 0 000-8z"})}),e.jsx("p",{className:"text-lg font-semibold",children:"No tienes postulaciones aún"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Una vez te postules a vacantes, aparecerán aquí."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full table-auto border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200",children:[e.jsx("th",{className:"px-6 py-3 text-left text-gray-600",children:"Vacante"}),e.jsx("th",{className:"px-6 py-3 text-left text-gray-600",children:"Fecha"}),e.jsx("th",{className:"px-6 py-3 text-left text-gray-600",children:"Estado"}),e.jsx("th",{className:"px-6 py-3 text-left text-gray-600",children:"Acciones"})]})}),e.jsx("tbody",{children:i.map(t=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"px-6 py-4 text-gray-800",children:t.vacante.titulo}),e.jsx("td",{className:"px-6 py-4 text-gray-800",children:t.fechaPostulacion||"-"}),e.jsx("td",{className:"px-6 py-4 text-gray-800",children:t.estado||"Espera"}),e.jsxs("td",{className:"px-6 py-4 space-x-2",children:[e.jsx("button",{onClick:()=>$(t.vacante.id),className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg",children:"Ver Vacante"}),t.estado!=="Rechazada"&&e.jsx("button",{onClick:()=>S(t.nPostulacion,!1,t.vacante.id),className:"bg-red-600 hover:bg-red-700 text-white font-semibold py-2 px-4 rounded-lg",children:"Cancelar"})]})]},t.nPostulacion))})]}),e.jsx(M,{currentPage:r,setCurrentPage:c,totalPages:N})]})]})};export{L as default};
