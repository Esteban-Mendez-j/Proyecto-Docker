import{A as n,j as e,S as j}from"./sweetalert2.all.BzjA5z2z.js";import{r as a}from"./index.BVOCwoKb.js";import{m as k}from"./ManejarRespuesta.Bd8-Nm9C.js";/* empty css                          */import{P as O}from"./Paginacion.DN2WiRaF.js";const q=()=>{const[y,w]=a.useState([]),[l,d]=a.useState(1),[x]=a.useState(10),[N,v]=a.useState(1),[M]=a.useState(!0),[E,A]=a.useState(0),[$,S]=a.useState(""),[u,C]=a.useState(""),[m,P]=a.useState(""),[p,T]=a.useState(""),[h,I]=a.useState(""),[r,U]=a.useState(!1),[R,f]=a.useState(null),c=async()=>{try{const t=`${n}/api/admin/listar/filtrados?nombre=${u}&rolPrinciapl=${h}&estado=${!r}&page=${l-1}&size=${x}`,i=await fetch(t,{credentials:"include"}),o=await k(i);if(!o)return;A(o.totalElements),w(o.usuarios||[]),v(o.totalPages)}catch(t){console.error("Error:",t)}};a.useEffect(()=>{fetch(`${n}/api/usuarios/rol`,{credentials:"include"}).then(t=>t.json()).then(t=>{f(t.rolPrincipal)}).catch(t=>{console.error("Error al obtener el rol:",t),f("ROLE_INVITADO")})},[]),a.useEffect(()=>{c()},[l,x,u,h,r,$]);const B=async(t,i)=>{const o=i?"crear este admin":"revocar este administrador";(await j.fire({title:`¿Estás seguro de ${o}?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, confirmar",cancelButtonText:"Cancelar"})).isConfirmed&&fetch(`${n}/api/admin/agregarRol?idUsuario=${t}&estado=${i}`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},credentials:"include"}).then(s=>{if(!s.ok)throw new Error("Error al modificar el rol del admin");return s.json()}).then(s=>{S(s.idUsuario),c()}).catch(s=>console.error("Error al modificar el rol del admin:",s))},b=async(t,i)=>{const{isConfirmed:o,value:g}=await j.fire({title:`Escribe el motivo ${i?"de la activación":"del baneo"}`,input:"text",inputLabel:"Comentario",inputPlaceholder:"Escribe aquí...",showCancelButton:!0,confirmButtonText:"Enviar",inputValidator:s=>{if(!s)return"El comentario es obligatorio"}});o&&fetch(`${n}/api/admin/cambiar-estado/usuario?idUsuario=${t}&estado=${i}&comentario=${encodeURIComponent(g)}`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},credentials:"include"}).then(s=>{if(!s.ok)throw new Error("Error al cambiar el estado del usuario");return s.json()}).then(()=>{c()}).catch(s=>console.error("Error al cambiar el estado del usuario:",s))},D=()=>{C(m),I(p),d(1)};return e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Gestión de Usuarios"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",placeholder:"Buscar usuarios...",value:m,onChange:t=>P(t.target.value),className:"py-2 pl-10 pr-4 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),e.jsxs("select",{value:p,onChange:t=>T(t.target.value),className:"px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Todos los tipos"}),R!=="ROLE_ADMIN"&&e.jsx("option",{value:"ADMIN",children:"Administradores"}),e.jsx("option",{value:"CANDIDATO",children:"Candidatos"}),e.jsx("option",{value:"EMPRESA",children:"Empresas"})]}),e.jsx("button",{onClick:D,className:"px-4 py-2 text-white bg-blue-600 rounded-md hover:bg-blue-700",children:"Buscar"}),e.jsx("button",{onClick:()=>U(!r),className:"px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600",children:r?"Ver Activos":"Ver Baneados"})]})]}),e.jsxs("p",{className:"mb-2 text-sm text-gray-600",children:[E," Usuarios ",r?"Baneados":"Activos"]}),e.jsx("div",{className:"overflow-hidden bg-white border border-gray-100 rounded-lg shadow-sm",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:`px-6 py-3 text-xs font-medium text-left uppercase ${r?"text-red-800":"text-blue-500"}`,children:"Nombre"}),e.jsx("th",{className:`px-6 py-3 text-xs font-medium text-left uppercase ${r?"text-red-800":"text-blue-500"}`,children:"Email"}),e.jsx("th",{className:`px-6 py-3 text-xs font-medium text-left uppercase ${r?"text-red-800":"text-blue-500"}`,children:"Tipo"}),r?e.jsx("th",{className:"px-6 py-3 text-xs font-medium text-left uppercase text-red-800",children:"Comentario Admin"}):e.jsx("th",{className:"px-6 py-3 text-xs font-medium text-left uppercase text-blue-500",children:"Fecha Registro"}),e.jsx("th",{className:`px-6 py-3 text-xs font-medium text-left uppercase ${r?"text-red-800":"text-blue-500"}`,children:"Último Acceso"}),e.jsx("th",{className:`px-6 py-3 text-xs font-medium text-right uppercase ${r?"text-red-800":"text-blue-500"}`,children:"Acciones"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:y.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.nombre}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.correo}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${t.rolPrinciapl==="CANDIDATO"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"}`,children:t.rolPrinciapl})}),r?e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.comentarioAdmin||"-"}):e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.fechaRegistro||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.fechaInicioSesion||"-"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsx("button",{onClick:()=>B(t.idUsuario,t.rolPrinciapl!=="ADMIN"),className:`hover:underline font-semibold ${t.rolPrinciapl==="ADMIN"?"text-black hover:text-gray-800":"text-purple-600 hover:text-purple-800"}`,children:t.rolPrinciapl==="ADMIN"?"- Admin":"+ Admin"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"}),e.jsx("a",{className:"mr-3 text-blue-600 hover:text-blue-900",href:`/perfil/${t.rolPrinciapl.toLowerCase()}/${t.idUsuario}`,children:" Ver Perfil"}),r?e.jsx("button",{onClick:()=>b(t.idUsuario,!0),className:"text-green-600 hover:text-green-800",children:"Reactivar"}):e.jsx("button",{onClick:()=>b(t.idUsuario,!1),className:"text-red-600 hover:text-red-800",children:"Banear"})]})]},t.idUsuario))})]})}),e.jsx("div",{className:"p-4",children:e.jsx(O,{currentPage:l,setCurrentPage:d,totalPages:N})})]})};export{q as default};
